import os
from summarizer.gigachat_summarizer import summarize_text
from dotenv import load_dotenv

load_dotenv()

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ .env
CLIENT_ID = os.getenv("GIGACHAT_CLIENT_ID")
CLIENT_SECRET = os.getenv("GIGACHAT_CLIENT_SECRET")
SCOPE = os.getenv("GIGACHAT_SCOPE")
OAUTH_URL = os.getenv("GIGACHAT_OAUTH_URL")
API_URL = os.getenv("GIGACHAT_API_URL")
AUTH_KEY = os.getenv("GIGACHAT_AUTH_KEY")


os.environ["GIGACHAT_AUTH_KEY"] = AUTH_KEY

# –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
test_cases = [
    {
        "name": "–ö–æ—Ä–æ—Ç–∫–∏–π —Ç–µ–∫—Å—Ç",
        "input": {"text": "–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ - —ç—Ç–æ –ø–æ–¥—Ä–∞–∑–¥–µ–ª –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π —Ñ–æ–∫—É—Å–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –º–æ–¥–µ–ª–µ–π, –ø–æ–∑–≤–æ–ª—è—é—â–∏—Ö –∫–æ–º–ø—å—é—Ç–µ—Ä–∞–º –≤—ã–ø–æ–ª–Ω—è—Ç—å –∑–∞–¥–∞—á–∏ –±–µ–∑ —è–≤–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è."}
    },
    {
        "name": "–°—Ä–µ–¥–Ω–∏–π —Ç–µ–∫—Å—Ç",
        "input": {"text": "–ì–ª—É–±–æ–∫–æ–µ –æ–±—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–æ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, –æ—Å–Ω–æ–≤–∞–Ω–Ω–æ–µ –Ω–∞ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã—Ö –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç—è—Ö —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ —Å–ª–æ—è–º–∏. –≠—Ç–∏ —Å–µ—Ç–∏ —Å–ø–æ—Å–æ–±–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑–≤–ª–µ–∫–∞—Ç—å –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∏–∑ –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∏—Ö –æ—Å–æ–±–µ–Ω–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º–∏ –¥–ª—è –∑–∞–¥–∞—á —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –æ–±—Ä–∞–∑–æ–≤, –æ–±—Ä–∞–±–æ—Ç–∫–∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞ –∏ –¥—Ä—É–≥–∏—Ö —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–¥–∞—á."}
    },
    {
        "name": "–î–ª–∏–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç",
        "input": {"text": "–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ (ML) ‚Äî —ç—Ç–æ –æ–±–ª–∞—Å—Ç—å –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞, –∫–æ—Ç–æ—Ä–∞—è —Ñ–æ–∫—É—Å–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –º–æ–¥–µ–ª–µ–π, –ø–æ–∑–≤–æ–ª—è—é—â–∏—Ö –∫–æ–º–ø—å—é—Ç–µ—Ä–∞–º –≤—ã–ø–æ–ª–Ω—è—Ç—å –∑–∞–¥–∞—á–∏ –±–µ–∑ —è–≤–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è. –≠—Ç–∏ –º–æ–¥–µ–ª–∏ –æ–±—É—á–∞—é—Ç—Å—è –Ω–∞ –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ–±—ã –¥–µ–ª–∞—Ç—å –ø—Ä–æ–≥–Ω–æ–∑—ã –∏–ª–∏ –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è, –Ω–µ —Ç—Ä–µ–±—É—è —è–≤–Ω–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π. –ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø–æ–¥—Ö–æ–¥–æ–≤, —Ç–∞–∫–∏—Ö –∫–∞–∫ —Ä–µ–≥—Ä–µ—Å—Å–∏—è, –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è, –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –∏ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏. –û–Ω–æ —à–∏—Ä–æ–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ç–∞–∫–∏—Ö –æ–±–ª–∞—Å—Ç—è—Ö, –∫–∞–∫ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞, –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏."}
    },
    {
        "name": "–ö–æ—Ä–æ—Ç–∫–∏–π —Ç–µ–∫—Å—Ç (–∞–Ω–≥–ª–∏–π—Å–∫–∏–π)",
        "input": {"text": "Machine learning is a subset of AI that focuses on building systems that learn from data."}
    },
    {
        "name": "–†—É—Å—Å–∫–∏–π ‚Äî —Ç–µ–∫—Å—Ç —Å —ç–º–æ–¥–∑–∏ –∏ –≤—Å—Ç—É–ø–ª–µ–Ω–∏–µ–º",
        "input": {"text": "–ü—Ä–∏–≤–µ—Ç! üëã –°–µ–≥–æ–¥–Ω—è —è —Ä–∞—Å—Å–∫–∞–∂—É –ø—Ä–æ –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ. ü§ñ –≠—Ç–æ –æ—á–µ–Ω—å –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ!"}
    },
    {
        "name": "–†—É—Å—Å–∫–∏–π ‚Äî —Ç–µ–∫—Å—Ç —Å —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π –æ–∫—Ä–∞—Å–∫–æ–π",
        "input": {"text": "–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ ‚Äî —ç—Ç–æ –±–µ–∑—É–º–Ω–æ –∫—Ä—É—Ç–∞—è —à—Ç—É–∫–∞! –í—ã –Ω–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç–µ, —Å–∫–æ–ª—å–∫–æ –æ–Ω–æ –º–æ–∂–µ—Ç!"}
    },
    {
        "name": "–ê–Ω–≥–ª–∏–π—Å–∫–∏–π ‚Äî –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç",
        "input": {"text": "Artificial intelligence is transforming industries by automating decision-making processes."}
    },
    {
        "name": "–ê–Ω–≥–ª–∏–π—Å–∫–∏–π ‚Äî —Ç–µ–∫—Å—Ç —Å —ç–º–æ–¥–∑–∏ –∏ –Ω–µ—Ñ–æ—Ä–º–∞–ª—å–Ω—ã–º —Å—Ç–∏–ª–µ–º",
        "input": {"text": "Hey there! üöÄ Let‚Äôs talk about AI and how it‚Äôs changing the world üåç!"}
    },
    {
        "name": "–ò—Å–ø–∞–Ω—Å–∫–∏–π ‚Äî —Ñ–æ—Ä–º–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å",
        "input": {"text": "La inteligencia artificial permite automatizar procesos mediante algoritmos avanzados y redes neuronales."}
    },
    {
        "name": "–ö–∏—Ç–∞–π—Å–∫–∏–π ‚Äî –∫–æ—Ä–æ—Ç–∫–∏–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Ç–µ–∫—Å—Ç",
        "input": {"text": "‰∫∫Â∑•Êô∫ËÉΩÈÄöËøáÊ∑±Â∫¶Â≠¶‰π†ÂÆûÁé∞ÂõæÂÉèËØÜÂà´ÂíåËØ≠Èü≥ËØÜÂà´„ÄÇ"}
    },
    {
        "name": "–ö–∏—Ç–∞–π—Å–∫–∏–π ‚Äî —Ç–µ–∫—Å—Ç —Å —ç–º–æ–¥–∑–∏",
        "input": {"text": "‰Ω†Â•ΩÔºÅü§ñ ‰∫∫Â∑•Êô∫ËÉΩÊ≠£Âú®ÊîπÂèòÊàë‰ª¨ÁöÑÁîüÊ¥ªÔºÅüì±"}
    },
    {
        "name": "–ù–µ–º–µ—Ü–∫–∏–π ‚Äî –¥–ª–∏–Ω–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ",
        "input": {"text": "K√ºnstliche Intelligenz ist ein Bereich der Informatik, der sich mit der Entwicklung intelligenter Systeme besch√§ftigt, die Aufgaben ohne menschliches Eingreifen ausf√ºhren k√∂nnen."}
    },
    {
        "name": "–§—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π ‚Äî –Ω–∞—É—á–Ω—ã–π —Å—Ç–∏–ª—å",
        "input": {"text": "L'apprentissage automatique est une branche de l'IA qui permet aux machines d'apprendre √† partir de donn√©es sans √™tre explicitement programm√©es."}
    },
    {
        "name": "–†—É—Å—Å–∫–∏–π ‚Äî —Ç–µ–∫—Å—Ç < 140 —Å–∏–º–≤–æ–ª–æ–≤, –Ω–æ —Å –º—É—Å–æ—Ä–æ–º",
        "input": {"text": "üåü –í–∫—Ä–∞—Ç—Ü–µ: –ò–ò ‚Äî —ç—Ç–æ —Å—É–ø–µ—Ä! üëç –û–Ω —É–º–µ–µ—Ç –≤—Å—ë –∏ –¥–∞–∂–µ –±–æ–ª—å—à–µ! –í —ç—Ç–æ–º –≤—Å—è —Å—É—Ç—å, –ø—Ä–∞–≤–¥–∞ –≤–µ–¥—å?"}
    },
    {
        "name": "–†—É—Å—Å–∫–∏–π ‚Äî —Ç–µ–∫—Å—Ç —Ä–æ–≤–Ω–æ 140 —Å–∏–º–≤–æ–ª–æ–≤",
        "input": {"text": "–ò–ò –ø–æ–∑–≤–æ–ª—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á–∏, –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –±–æ–ª—å—à–∏–µ –¥–∞–Ω–Ω—ã–µ, –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏—è –∏ —É–ª—É—á—à–∞—Ç—å –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å—ã –∫–æ–º–ø–∞–Ω–∏–π –∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π."}
    },
    {
        "name": "–ê–Ω–≥–ª–∏–π—Å–∫–∏–π ‚Äî —Ç–µ–∫—Å—Ç —Å —Ñ—Ä–∞–∑–∞–º–∏ ¬´in summary¬ª, ¬´to conclude¬ª",
        "input": {"text": "In summary, machine learning is an essential component of modern AI systems. To conclude, it enables adaptive behavior."}
    },
    {
        "name": "–§—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π ‚Äî —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –æ—Ç–∑—ã–≤",
        "input": {"text": "J'adore l'intelligence artificielle ! C‚Äôest incroyable ce qu‚Äôelle peut faire aujourd‚Äôhui üòç"}
    },
    {
        "name": "–ú—É—Å–æ—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç –Ω–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–º —è–∑—ã–∫–µ",
        "input": {"text": "asfkasf!@# sakfjh3r fasdf/// fjqf üòÅ"}
    },
    {
        "name": "–†—É—Å—Å–∫–∏–π ‚Äî —Ç–µ–∫—Å—Ç —Å –º–∞—Ç–æ–º",
        "input": {"text": "–≠—Ç–∞ —á—ë—Ä—Ç–æ–≤–∞ —Å–∏—Å—Ç–µ–º–∞ –æ–ø—è—Ç—å —Å–ª–æ–º–∞–ª–∞—Å—å, –∫–∞–∫–æ–≥–æ —Ö—Ä–µ–Ω–∞ –Ω–∏–∫—Ç–æ –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç?"}
    },
    {
        "name": "–ê–Ω–≥–ª–∏–π—Å–∫–∏–π ‚Äî HTML-—Ç–µ–≥–∏",
        "input": {"text": "<div>Hello!</div><p>This is <strong>important</strong> text about AI.</p>"}
    },
    {
        "name": "–†—É—Å—Å–∫–∏–π ‚Äî —Ç–µ–∫—Å—Ç —Å –ª–æ–∂—å—é",
        "input": {"text": "–ò–ª–æ–Ω –ú–∞—Å–∫ —Ä–æ–¥–∏–ª—Å—è –≤ –†–æ—Å—Å–∏–∏ –∏ –∏–∑–æ–±—Ä—ë–ª –±–∞–ª–∞–ª–∞–π–∫—É."}
    },
    {
        "name": "–ú—É—Å–æ—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç ‚Äî –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω—ã–π –≤–≤–æ–¥",
        "input": {"text": "a9s8d7f98sd!@# lksdjf/// \n\n wfwfj üòµ‚Äçüí´ \n\n ü§Øüí£ <br>"}
    }
]

def test_summarizer():
    print("–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏")
    print("=" * 50)
    
    for i, test_case in enumerate(test_cases, 1):
        print(f"\n–¢–µ—Å—Ç {i}: {test_case['name']}")
        print(f"–í—Ö–æ–¥: {test_case['input']['text'][:100]}...")
        
        result = summarize_text(test_case['input'])
        
        if 'error' in result:
            print(f"–û—à–∏–±–∫–∞: {result['error']}")
        else:
            print(f"–†–µ–∑—É–ª—å—Ç–∞—Ç: {result['summary']}")
            print(f"–î–ª–∏–Ω–∞: {len(result['summary'])} —Å–∏–º–≤–æ–ª–æ–≤")
        
        print("-" * 30)

if __name__ == "__main__":
    test_summarizer() 